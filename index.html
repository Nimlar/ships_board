<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>snap svg</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
<style type="text/css">
            html, body {
                height: 100%;
            }
            #svg {
                width: 100%;
                height: 100%;
                border: solid 0px ;
                margin: 0 0;
                padding: 0 0;
               /* background:url("space.jpg")  repeat;*/
            }
        </style>
  </head>
  <body >
  <svg id="svg">
  <defs></defs>
  </svg>
<script type="text/javascript" src="snap.svg-min.js"></script>
<script>

function move()
{
    var width = document.getElementById('svg').offsetWidth;
    var height = document.getElementById('svg').offsetHeight;
    //console.log(JSON.stringify(this), ["img"], 4);
    var x0=this.prev[0]*width;
    var y0=this.prev[1]*height;
    var x1=this.pos[0]*width;
    var y1=this.pos[1]*height;

    var angle=Snap.angle(x1,y1,x0,y0);
    var t=new Snap.Matrix();
    t.translate(x1, y1);
    t.rotate(angle,0,0);
    this.img.animate({transform :t}, 1000);
}


    var s = Snap("#svg");
     _ships=[{ pos : [0  ,0    ],     prev :[.2  ,.3  ], color: "yellow", move:move},
             { pos : [.5  ,.5  ],     prev :[.2  ,.3  ], color: "red", move:move},
             { pos : [.4  ,.5  ],     prev :[.2  ,.3  ], color: "green", move:move},
             { pos : [.001,0.83],     prev :[.2  ,.3  ], color: "blue", move:move},
             { pos : [.03 ,.83 ],     prev :[.2  ,.3  ], color: "gray", move:move} ];
      ships=_ships;
//      ships=[_ships[1]];
//      ships=[_ships[0],_ships[1]];

function move_ship(ship)
{
    var t=new Snap.Matrix();
    if (ship.img === undefined) {
        Snap.load("fleche.svg", function(e) {
            var f=e.select("g"); /* get the internal data of svg */
            f.select("#center").attr({fill: this.color});
            s.append(f);
            this.img=f;
            this.move();
        }, ship);
    } else {
        ship.move()
    }
}

function move_all(){
    for(i=0;i<ships.length;i++){
        move_ship(ships[i]);
        ships[i].prev[0]=ships[i].pos[0]
        ships[i].prev[1]=ships[i].pos[1]
        ships[i].pos[0]=(ships[i].pos[0] + .08*Math.random()) % 1
        ships[i].pos[1]=(ships[i].pos[1] + .08*Math.random()) % 1

    }
}


</script>
  <input type="button" value="event" onclick="move_all();"/>
  </body>
</html>
